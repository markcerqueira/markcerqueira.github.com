<!DOCTYPE html>
<html lang="en-us">

  <head>
  <link href="http://gmpg.org/xfn/11" rel="profile">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta http-equiv="content-type" content="text/html; charset=utf-8">

  <!-- Enable responsiveness on mobile devices-->
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">

  <title>
    
      Don't Tell Me to Share a Secret &middot; mark cerqueira
    
  </title>

  <!-- CSS -->
  <link rel="stylesheet" href="/public/css/poole.css">
  <link rel="stylesheet" href="/public/css/syntax.css">
  <link rel="stylesheet" href="/public/css/lanyon.css">
  <link rel="stylesheet" href="/public/css/tags.css">
  <link rel="stylesheet" href="/public/css/v1.css">
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Source%20Sans%20Pro">

  <!-- Icons -->
  <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/public/apple-touch-icon-precomposed.png">
  <link rel="shortcut icon" href="/public/favicon.ico">

  <!-- RSS -->
  <link rel="alternate" type="application/rss+xml" title="RSS" href="/atom.xml">
</head>


  <body class="theme-base-0d">

    <!-- Target for toggling the sidebar `.sidebar-checkbox` is for regular
     styles, `#sidebar-checkbox` for behavior. -->
<input type="checkbox" class="sidebar-checkbox" id="sidebar-checkbox">

<!-- Toggleable sidebar -->
<div class="sidebar" id="sidebar">
  <div class="sidebar-item">
    <p></p>
  </div>

  <nav class="sidebar-nav">
    <a class="sidebar-nav-item" href="/">home</a>
    <a class="sidebar-nav-item" href="/about/">about</a>     
    <a class="sidebar-nav-item" href="/archive/">archive</a>
    <a class="sidebar-nav-item" href="/fitness/">fitness</a>
    <a class="sidebar-nav-item" href="/projects/">projects</a>
  </nav>
</div>


    <!-- Wrap is the content to shift when toggling the sidebar. We wrap the
         content to avoid any CSS collisions with our real content. -->
    <div class="wrap">
      <div class="masthead">
        <div class="container">
          <h3 class="masthead-title">
            <a href="/" title="Home">mark cerqueira</a>
            <small>well-rounded nerd</small>
          </h3>
        </div>
      </div>

      <div class="container content">
        <div class="post">
  <h1 class="post-title">Don't Tell Me to Share a Secret</h1>
  <span class="post-date">08 Jan 2015</span>
  <p>My friend Spencer asked me if I could beta test Mini Audicle for iOS. I agreed and asked him if he had any performance monitoring tools set up. Long story short, I ended up integrating <strong>Crittercism</strong> (my favorite crash monitoring tool) into Mini Audicle iOS so he could collect crash data from every user.</p>

<p>One important part of the Crittercism integration process is <strong>uploading dSYMs - debug symbol files</strong>. For release builds, debug symbols are removed to reduce the binary size but this makes crash logs much less useful. Fortunately, dSYM files help us decode (symbolicate) these crash reports. It’s super important to upload dSYMs if you want to make any sense of stack traces.</p>

<p>Fortunately, Crittercism <a href="http://support.crittercism.com/articles/knowledge_base/Uploading-dSYMs-to-Crittercism-automatically/">provides thorough instructions</a> on setting up automatic dSYM upload, but it’s not all sunshine and rainbows.</p>

<!--break-->

<p>The instructions help you set up a script that runs after the build phase is complete.</p>

<div>
	<img style="max-width: 400px; border: 0px solid #000000;" src="/assets/images/posts/2015-01-08/not_the_key.png" />
	<p class="caption-text" style="line-height: 1.5em;  margin-bottom: 24px;"><strong>Something is fishy here...</strong></p>
</div>

<p>What’s wrong with this? <strong>The API key is right there, in plain sight!</strong> As soon as you push this up, your key is available for all to see! While it seems you currently can’t do much damage with the <a href="http://docs.crittercism.com/api/api.html">Crittercism REST API</a>, you probably shouldn’t instruct customers to just put their API key out there for everyone to see. You should AT LEAST warn them about the potential dangers of sharing this key.</p>

<p><strong>Benefit of the doubt time!</strong> I can imagine Crittercism is mostly integrated into enterprise applications that are hosted <strong>privately</strong>. But even in that case, ideally, only your build server, which makes builds for non-developers, would have access to the API key. To that end, Crittercism provides a <a href="https://wiki.jenkins-ci.org/display/JENKINS/Crittercism+dSYM+Plugin">Jenkins plugin</a> eliminating the need to put the API key directly in your source code.</p>

<p>But if you’re a public open source project, do not have a build server, and want to have auto-uploading dSYMs to Crittercism what options do you have? You can still use their method safely by modifying Crittercism’s provided instructions a bit. Here is what Mini Audicle iOS uses:</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="c"># only upload during Release builds, otherwise every build will upload a dSYM</span>
<span class="k">if</span> <span class="o">[</span> <span class="s2">"</span><span class="k">${</span><span class="nv">CONFIGURATION</span><span class="k">}</span><span class="s2">"</span> <span class="o">=</span> <span class="s2">"Release"</span> <span class="o">]</span>; <span class="k">then</span>
    <span class="c"># put the secret key in this file as an environmental variable</span>
    <span class="k">if</span> <span class="o">[</span> -f ~/.crittercism_keys <span class="o">]</span>; <span class="k">then</span>
		<span class="c"># this is required to inject the environmental variables into</span>
		<span class="c"># the shell spawned by Xcode</span>
        <span class="nb">source</span> ~/.crittercism_keys

        <span class="nv">APP_ID</span><span class="o">=</span><span class="s2">"MY_FIRST_APP_ID_abcdefghi"</span>

		<span class="c"># instead of having your API key here, it is copied in from the</span>
		<span class="c"># environmental varible</span>
        <span class="nv">API_KEY</span><span class="o">=</span><span class="k">${</span><span class="nv">MINI_AUDICLE_SECRET_KEY</span><span class="k">}</span>

		<span class="c"># run the script</span>
        <span class="nb">source</span> <span class="s2">"</span><span class="k">${</span><span class="nv">SRCROOT</span><span class="k">}</span><span class="s2">"</span>/ios/libs/Crittercism/dsym_upload.sh
    <span class="k">else
        </span><span class="nb">echo</span> <span class="s2">"~/.crittercism_keys does not exist. Not uploading dSYM!"</span>
    <span class="k">fi
else
    </span><span class="nb">echo</span> <span class="s2">"Not a Release build so not auto-uploading dSYM file."</span>
<span class="k">fi</span></code></pre></figure>

<p>It requires a little setup (creating the .crittercism_keys file), but we can now <strong>both auto-upload dSYMs and host this project publicly without exposing the API key</strong>. This script also only upload dSYMs for Release builds.</p>


</div>

<div class="related">
  <h2>Related Posts</h2>
  <ul class="related-posts">
    
      <li>
        <h3>
          <a href="/2016/08/04/changing-progress-bar-color/">
            Changing Progress Bar Spinner Color
            <small>04 Aug 2016</small>
          </a>
        </h3>
      </li>
    
      <li>
        <h3>
          <a href="/2016/07/30/ruby-datetime-nsdate/">
            Ruby DateTime to Objective-C NSDate
            <small>30 Jul 2016</small>
          </a>
        </h3>
      </li>
    
      <li>
        <h3>
          <a href="/2016/07/28/concert-review-final-symphony/">
            Concert Review: Final Symphony, San Francisco, 7/28/16
            <small>28 Jul 2016</small>
          </a>
        </h3>
      </li>
    
  </ul>
</div>

      </div>
    </div>

    <label for="sidebar-checkbox" class="sidebar-toggle"></label>

    <script>
      (function(document) {
        var toggle = document.querySelector('.sidebar-toggle');
        var sidebar = document.querySelector('#sidebar');
        var checkbox = document.querySelector('#sidebar-checkbox');

        document.addEventListener('click', function(e) {
          var target = e.target;

          if(!checkbox.checked ||
             sidebar.contains(target) ||
             (target === checkbox || target === toggle)) return;

          checkbox.checked = false;
        }, false);
      })(document);
    </script>
  </body>
</html>
